# request_data = '{"response":{"actions":[],"schema":"{\\r\\n  \\"$schema\\": \\"http://json-schema.org/draft-04/schema\\",\\r\\n  \\"type\\": \\"object\\",\\r\\n  \\"properties\\": {\\r\\n    \\"type\\": {\\r\\n      \\"type\\": \\"string\\",\\r\\n      \\"enum\\": [ \\"onTokenIssuanceStartCustomExtension\\" ]\\r\\n    },\\r\\n    \\"apiSchemaVersion\\": {\\r\\n      \\"type\\": \\"string\\",\\r\\n      \\"enum\\": [ \\"10-01-2021-preview\\" ]\\r\\n    },\\r\\n    \\"actions\\": {\\r\\n      \\"type\\": \\"array\\",\\r\\n      \\"minItems\\": 1,\\r\\n      \\"maxItems\\": 1,\\r\\n      \\"items\\": {\\r\\n        \\"type\\": \\"object\\",\\r\\n        \\"properties\\": {\\r\\n          \\"type\\": {\\r\\n            \\"type\\": \\"string\\",\\r\\n            \\"enum\\": [ \\"ProvideClaimsForToken\\" ]\\r\\n          }\\r\\n        },\\r\\n        \\"allOf\\": [\\r\\n          {\\r\\n            \\"anyOf\\": [\\r\\n              {\\r\\n                \\"not\\": {\\r\\n                  \\"properties\\": { \\"type\\": { \\"enum\\": [\\"ProvideClaimsForToken\\"] } }\\r\\n                }\\r\\n              },\\r\\n              { \\r\\n                \\"properties\\": { \\"claims\\": {\\"$ref\\": \\"#/definitions/claimsForToken\\"} },\\r\\n                \\"required\\": [\\"claims\\"]\\r\\n              }\\r\\n            ]\\r\\n          }\\r\\n        ],\\r\\n        \\"required\\": [\\r\\n          \\"type\\"\\r\\n        ]\\r\\n      }\\r\\n    }\\r\\n  },\\r\\n  \\"required\\": [\\r\\n    \\"type\\",\\r\\n    \\"apiSchemaVersion\\",\\r\\n    \\"actions\\"\\r\\n  ],\\r\\n\\r\\n  \\"definitions\\": {\\r\\n    \\r\\n    \\"claimsForToken\\": {\\r\\n      \\"type\\": \\"array\\",\\r\\n      \\"items\\": {\\r\\n        \\"$ref\\": \\"#/definitions/claim\\"\\r\\n      }\\r\\n    },\\r\\n\\r\\n    \\"claim\\": {\\r\\n      \\"type\\": \\"object\\",\\r\\n      \\"properties\\": {\\r\\n        \\"id\\": {\\r\\n          \\"type\\": \\"string\\"\\r\\n        },\\r\\n        \\"value\\": {\\r\\n          \\"oneOf\\": [\\r\\n            {\\r\\n              \\"type\\": \\"string\\"\\r\\n            },\\r\\n            {\\r\\n              \\"type\\": \\"array\\",\\r\\n              \\"items\\": {\\r\\n                \\"type\\": \\"string\\"\\r\\n              }\\r\\n            }\\r\\n          ]\\r\\n        }\\r\\n      },\\r\\n      \\"required\\": [\\r\\n        \\"id\\",\\r\\n        \\"value\\"\\r\\n      ]\\r\\n    }\\r\\n  }\\r\\n  \\r\\n}","body":"{\\r\\n  \\"type\\": \\"onTokenIssuanceStartCustomExtension\\",\\r\\n  \\"apiSchemaVersion\\": \\"10-01-2021-preview\\",\\r\\n  \\"actions\\": []\\r\\n}"},"payload":{"authenticationContext":{"correlationId":"20000000-0000-0000-0000-000000000002","client":{"ip":"127.0.0.1"},"authProtocol":{"type":"OAUTH2.0","tenantId":"30000000-0000-0000-0000-000000000003"},"clientServicePrincipal":{"id":"40000000-0000-0000-0000-000000000001","appId":"40000000-0000-0000-0000-000000000002","appDisplayName":"Test client app","displayName":"Test client application","servicePrincipalNames":["40000000-0000-0000-0000-000000000002","http://example.com/client/app1"]},"resourceServicePrincipal":{"id":"40000000-0000-0000-0000-000000000003","appId":"40000000-0000-0000-0000-000000000004","appDisplayName":"Test resourceapp","displayName":"Test resourceapplication","servicePrincipalNames":["40000000-0000-0000-0000-000000000004","https://example.com/resource2"]},"roles":[{"id":"50000000-0000-0000-0000-000000000005","value":"DummyRole"}],"user":{"ageGroup":"Adult","companyName":"Evo Sts Test","country":"USA","createdDateTime":"0001-01-01T00:00:00+00:00","creationType":"Invitation","department":"Dummy department","displayName":"Dummy display name","givenName":"Example","id":"60000000-0000-0000-0000-000000000006","lastPasswordChangeDateTime":"0001-01-01T00:00:00+00:00","mail":"test@example.com","onPremisesSamAccountName":"testadmin","onPremisesSecurityIdentifier":"DummySID","onPremiseUserPrincipalName":"Dummy Name","preferredDataLocation":"DummyDataLocation","preferredLanguage":"DummyLanguage","surname":"Test","userPrincipalName":"testadmin@example.com","userType":"UserTypeCloudManaged"}},"eventListenerId":"10000000-0000-0000-0000-000000000001","time":"2021-05-17T00:00:00+00:00","type":"onTokenIssuanceStartCustomExtension","apiSchemaVersion":"10-01-2021-preview","customExtensionId":"10000000-0000-0000-0000-000000000001"},"tokenClaims":null,"type": "onTokenIssuanceStartCustomExtension", "requestStatus":"Successful","statusMessage":"Ready","queryParameters": {"code": "rKjH4GcRhezoBbQWI3z3nt7svQbMGLi6HeEmJbxwVL7BixnL34VDTg==","functionName": "OnTokenIssuanceStart"}}'  # noqa: E501
# response_data = '{"actions": [{"actionType": "ProvideClaimsForToken", "claims": [{"id": "DateOfBirth", "value": "01/01/2000"}, {"id": "CustomRoles", "value": ["Writer", "Editor"]}]}], "schema": "{\\r\\n  \\"$schema\\": \\"http://json-schema.org/draft-04/schema\\",\\r\\n  \\"type\\": \\"object\\",\\r\\n  \\"properties\\": {\\r\\n    \\"type\\": {\\r\\n      \\"type\\": \\"string\\",\\r\\n      \\"enum\\": [ \\"onTokenIssuanceStartCustomExtension\\" ]\\r\\n    },\\r\\n    \\"apiSchemaVersion\\": {\\r\\n      \\"type\\": \\"string\\",\\r\\n      \\"enum\\": [ \\"10-01-2021-preview\\" ]\\r\\n    },\\r\\n    \\"actions\\": {\\r\\n      \\"type\\": \\"array\\",\\r\\n      \\"minItems\\": 1,\\r\\n      \\"maxItems\\": 1,\\r\\n      \\"items\\": {\\r\\n        \\"type\\": \\"object\\",\\r\\n        \\"properties\\": {\\r\\n          \\"type\\": {\\r\\n            \\"type\\": \\"string\\",\\r\\n            \\"enum\\": [ \\"ProvideClaimsForToken\\" ]\\r\\n          }\\r\\n        },\\r\\n        \\"allOf\\": [\\r\\n          {\\r\\n            \\"anyOf\\": [\\r\\n              {\\r\\n                \\"not\\": {\\r\\n                  \\"properties\\": { \\"type\\": { \\"enum\\": [\\"ProvideClaimsForToken\\"] } }\\r\\n                }\\r\\n              },\\r\\n              { \\r\\n                \\"properties\\": { \\"claims\\": {\\"$ref\\": \\"#/definitions/claimsForToken\\"} },\\r\\n                \\"required\\": [\\"claims\\"]\\r\\n              }\\r\\n            ]\\r\\n          }\\r\\n        ],\\r\\n        \\"required\\": [\\r\\n          \\"type\\"\\r\\n        ]\\r\\n      }\\r\\n    }\\r\\n  },\\r\\n  \\"required\\": [\\r\\n    \\"type\\",\\r\\n    \\"apiSchemaVersion\\",\\r\\n    \\"actions\\"\\r\\n  ],\\r\\n\\r\\n  \\"definitions\\": {\\r\\n    \\r\\n    \\"claimsForToken\\": {\\r\\n      \\"type\\": \\"array\\",\\r\\n      \\"items\\": {\\r\\n        \\"$ref\\": \\"#/definitions/claim\\"\\r\\n      }\\r\\n    },\\r\\n\\r\\n    \\"claim\\": {\\r\\n      \\"type\\": \\"object\\",\\r\\n      \\"properties\\": {\\r\\n        \\"id\\": {\\r\\n          \\"type\\": \\"string\\"\\r\\n        },\\r\\n        \\"value\\": {\\r\\n          \\"oneOf\\": [\\r\\n            {\\r\\n              \\"type\\": \\"string\\"\\r\\n            },\\r\\n            {\\r\\n              \\"type\\": \\"array\\",\\r\\n              \\"items\\": {\\r\\n                \\"type\\": \\"string\\"\\r\\n              }\\r\\n            }\\r\\n          ]\\r\\n        }\\r\\n      },\\r\\n      \\"required\\": [\\r\\n        \\"id\\",\\r\\n        \\"value\\"\\r\\n      ]\\r\\n    }\\r\\n  }\\r\\n  \\r\\n}", "body": "{\\r\\n  \\"type\\": \\"onTokenIssuanceStartCustomExtension\\",\\r\\n  \\"apiSchemaVersion\\": \\"10-01-2021-preview\\",\\r\\n  \\"actions\\": []\\r\\n}"}'  # noqa: E501
negative_event_type = "Event type 'Negative test string' not supported, supported event types are 'onTokenIssuanceStartCustomExtension', 'microsoft.graph.authenticationEvent.TokenIssuanceStart'"  # noqa: E501
# request_data='{"response": {"ODataType": "microsoft.graph.onTokenIssuanceStartResponseData","actions": [],"body": "{\r\n  \"data\": {\r\n    \"@odata.type\": \"\",\r\n    \"actions\": []\r\n  }\r\n}"},"payload": {"authenticationContext": {"correlationId": "20000000-0000-0000-0000-000000000002","client": {"ip": "127.0.0.1","locale": "en-us","market": "en-au"},"authenticationProtocol": "OAUTH2.0","clientServicePrincipal": {"id": "40000000-0000-0000-0000-000000000001","appId": "40000000-0000-0000-0000-000000000002","appDisplayName": "Test client app","displayName": "Test client application"},"resourceServicePrincipal": {"id": "40000000-0000-0000-0000-000000000003","appId": "40000000-0000-0000-0000-000000000004","appDisplayName": "Test resource app","displayName": "Test resource application"},"user": {"companyName": "Nick Gomez","country": "USA","displayName": "Dummy display name","givenName": "Example","id": "60000000-0000-0000-0000-000000000006","mail": "test@example.com","onPremisesSamAccountName": "testadmin","onPremisesSecurityIdentifier": "DummySID","onPremiseUserPrincipalName": null,"preferredDataLocation": "DummyDataLocation","preferredLanguage": "DummyLanguage","surname": "Test","userPrincipalName": "testadmin@example.com","userType": "UserTypeCloudManaged"}},"tenantId": "30000000-0000-0000-0000-000000000003","authenticationEventListenerId": "10000000-0000-0000-0000-000000000001","customAuthenticationExtensionId": "10000000-0000-0000-0000-000000000002"},"tokenClaims": null,"source": "/tenants/{tenantId}/applications/{resourceAppId}","@odata.type": "microsoft.graph.onTokenIssuanceStartCalloutData","type": "microsoft.graph.authenticationEvent.TokenIssuanceStart","requestStatus": "Successful","statusMessage": "Ready","queryParameters": {"code": "mNEwqtM0t7ZzNDn4IoJGy51dNlZb-7Pu0hJPFzzBi703AzFus9_flQ==","functionName": "onTokenIssuanceString"}}'
response_data='{"data": {"@odata.type": "microsoft.graph.onTokenIssuanceStartResponseData","actions": [{"type": "ProvideClaimsForToken","claims": [{"DateOfBirth": "01/01/2000"},{"CustomRoles": ["Writer","Editor"]}]}]}}'
request_data='{"response":{"oDataType":"microsoft.graph.onTokenIssuanceStartResponseData","actions":[],"body":"{\\r\\n  \\"type\\": \\"onTokenIssuanceStartCustomExtension\\",\\r\\n  \\"apiSchemaVersion\\": \\"10-01-2021-preview\\",\\r\\n  \\"actions\\": []\\r\\n}"},"payload":{"authenticationContext":{"correlationId":"20000000-0000-0000-0000-000000000002","client":{"ip":"127.0.0.1","locale":"en-us","market":"en-au"},"authenticationProtocol":"OAUTH2.0","clientServicePrincipal":{"id":"40000000-0000-0000-0000-000000000001","appId":"40000000-0000-0000-0000-000000000002","appDisplayName":"Testclientapp","displayName":"Testclientapplication"},"resourceServicePrincipal":{"id":"40000000-0000-0000-0000-000000000003","appId":"40000000-0000-0000-0000-000000000004","appDisplayName":"Testresourceapp","displayName":"Testresourceapplication"},"user":{"companyName":"NickGomez","country":"USA","displayName":"Dummydisplayname","givenName":"Example","id":"60000000-0000-0000-0000-000000000006","mail":"test@example.com","onPremisesSamAccountName":"testadmin","onPremisesSecurityIdentifier":"DummySID","onPremiseUserPrincipalName":null,"preferredDataLocation":"DummyDataLocation","preferredLanguage":"DummyLanguage","surname":"Test","userPrincipalName":"testadmin@example.com","userType":"UserTypeCloudManaged"}},"tenantId":"30000000-0000-0000-0000-000000000003","authenticationEventListenerId":"10000000-0000-0000-0000-000000000001","customAuthenticationExtensionId":"10000000-0000-0000-0000-000000000002"},"tokenClaims":null,"source":"/tenants/{tenantId}/applications/{resourceAppId}","oDataType":"microsoft.graph.onTokenIssuanceStartCalloutData","type":"microsoft.graph.authenticationEvent.TokenIssuanceStart","requestStatus":"Successful","statusMessage":"Ready","queryParameters":{"code":"mNEwqtM0t7ZzNDn4IoJGy51dNlZb-7Pu0hJPFzzBi703AzFus9_flQ==","functionName":"onTokenIssuanceString"}}'